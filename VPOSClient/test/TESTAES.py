from VPOSClient.utils import AES

data = """{"browserAcceptHeader":"1024","browserIP":"1.12.123.255","browserJavaEnabled":"true","browserLanguage":"it","browserColorDepth":"16","browserScreenHeight":"100","browserScreenWidth":"100","browserTZ":"-60","browserUserAgent":"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 firefox/47.0","addrmatch":"n","chaccageind":"04","chaccchange":"20190211","chaccchangeind":"03","chaccdate":"20190210","chaccpwchange":"20190214","chaccpwchangeind":"04","nbpurchaseaccount":"1000","txnactivityday":"100","txnactivityyear":"100","shipaddressusage":"20181220","shipaddressusageind":"03","shipnameindicator":"01","billaddrcity":"billaddrcity","billaddrcountry":"004","billaddrline1":"billaddrline1","billaddrline2":"billaddrline2","billaddrline3":"billaddrline3","billaddrpostcode":"billaddrpostcode","billaddrstate":"11","homephone":"39-321818198","mobilephone":"33-312","shipaddrcity":"zio","shipaddrcountry":"008","shipaddrline1":"shipaddrline1","shipaddrline2":"shipaddrline2","shipaddrline3":"shipaddrline3","shipaddrpostcode":"shipaddrpostcode","shipaddrstate":"222","workphone":"39-0321818198","deliveryemailaddress":"a-b@example.com","deliveryTimeframe":"02","preOrderDate":"20181220","preOrderPurchaseInd":"01","reorderItemsInd":"02","shipIndicator":"01"}"""
"""apikey = 'nS-zLHC35Pzu47m-AZtRejrd-xd2SsudbpKmmfGgD-9-dJjRQpm8pPJM84uEZgkgq-CfJ9n--sHNHjKx7--Aw-56jEqLVDe-aT-f'

print(Encoder.getMac('I&8032112928AT2hvou71o3tfl4&01&8712345788998754&10000&10000&978&0&0&00&2020-03-13T10:57:55&885845&09509&160204162734187&02','dnC8ybnbPaBSNYHsN5vq-pcaf5QXV2YHpFStxjGfY3wftC-7-PZkL5dbhP--em-DV24-YeCKMKr-ENZ-nE3JHMvqeyYDKJ3wK8b2',hashlib.sha256))
"""
data_redirect = """{"addrMatch":"N","chAccAgeInd":"04","chAccChange":"20190211","chAccChangeInd":"03","chAccDate":"20190210","chAccPwChange":"20190214","chAccPwChangeInd":"04","nbPurchaseAccount":"1000","txnActivityDay":"100","txnActivityYear":"100","shipAddressUsage":"20181220","shipAddressUsageInd":"03","shipNameIndicator":"01","billAddrCity":"billAddrCity","billAddrCountry":"004","billAddrLine1":"billAddrLine1","billAddrLine2":"billAddrLine2","billAddrLine3":"billAddrLine3","billAddrPostCode":"billAddrPostCode","billAddrState":"MI","homePhone":"39-321818198","mobilePhone":"33-312","shipAddrCity":"zio","shipAddrCountry":"008","shipAddrLine1":"shipAddrLine1","shipAddrLine2":"shipAddrLine2","shipAddrLine3":"shipAddrLine3","shipAddrPostCode\":\"shipAddrPostCode","shipAddrState":"222","workPhone":"39-0321818198","deliveryEmailAddress":"a-b@example.com","deliveryTimeframe":"02","preOrderDate":"20181220","preOrderPurchaseInd":"01","reorderItemsInd":"02","shipIndicator":"01"}"""
apiResultKey = 'hSAc7sg-z-vZ-296FuwwUaqHmzQ-eQ-E--2pXV-mEGh6YQtBdDK-NH9KeCyQrtBtmwFv-m6kEUtn27-6ATfkB-x2Dy3F4G-9t4sp'

print(AES.AES_encrypt(
    """{"billAddrLine3":"billAddrLine3","chAccChange":"20190211","shipAddrCountry":"008","billAddrCity":"billAddrCity","shipNameIndicator":"01","workPhone":"39-0321818198","addrMatch":"N","preOrderDate":"20181220","homePhone":"39-321818198","deliveryEmailAddress":"a-b@example.com","billAddrPostCode":"billAddrPostCode","shipAddressUsage":"20181220","shipIndicator":"01","txnActivityDay":"100","shipAddrPostCode":"shipAddrPostCode","billAddrCountry":"004","shipAddrLine2":"shipAddrLine2","billAddrState":"MI","shipAddrState":"222","nbPurchaseAccount":"1000","preOrderPurchaseInd":"01","txnActivityYear":"100","shipAddressUsageInd":"03","chAccChangeInd":"03","shipAddrLine1":"shipAddrLine1","chAccDate":"20190210","mobilePhone":"33-312","chAccPwChangeInd":"04","chAccAgeInd":"04","billAddrLine2":"billAddrLine2","reorderItemsInd":"02","chAccPwChange":"20190214","shipAddrLine3":"shipAddrLine3","shipAddrCity":"zio","billAddrLine1":"billAddrLine1"}""",
    apiResultKey))
